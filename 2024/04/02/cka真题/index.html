<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>cka真题 | Eryoung2的个人博客</title><meta name="keywords" content="cka"><meta name="author" content="ErYoung2"><meta name="copyright" content="ErYoung2"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="Part1 17个题目第1题.基于角色的访问控制-RBAC第2题.节点维护—指定node节点不可用第3题.K8s版本升级第4题.Etcd数据库备份恢复第5题.网络策略NetworkPolicy第6题.四层负载均衡service第7题.七层负载均衡Ingress第8题.Deployment管理pod扩缩容第9题.pod指定节点部署第10题.检查Node节点的健康状态第11题.一个Pod封装多个容器第">
<meta property="og:type" content="article">
<meta property="og:title" content="cka真题">
<meta property="og:url" content="http://eryoung2.github.io/2024/04/02/cka%E7%9C%9F%E9%A2%98/index.html">
<meta property="og:site_name" content="Eryoung2的个人博客">
<meta property="og:description" content="Part1 17个题目第1题.基于角色的访问控制-RBAC第2题.节点维护—指定node节点不可用第3题.K8s版本升级第4题.Etcd数据库备份恢复第5题.网络策略NetworkPolicy第6题.四层负载均衡service第7题.七层负载均衡Ingress第8题.Deployment管理pod扩缩容第9题.pod指定节点部署第10题.检查Node节点的健康状态第11题.一个Pod封装多个容器第">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-04-01T18:01:18.000Z">
<meta property="article:modified_time" content="2024-04-01T18:02:17.498Z">
<meta property="article:author" content="ErYoung2">
<meta property="article:tag" content="cka">
<meta name="twitter:card" content="summary"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://eryoung2.github.io/2024/04/02/cka%E7%9C%9F%E9%A2%98/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'cka真题',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-04-02 02:02:17'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Eryoung2的个人博客" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/panda.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">121</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">57</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">28</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Eryoung2的个人博客</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">cka真题</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-04-01T18:01:18.000Z" title="发表于 2024-04-02 02:01:18">2024-04-02</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-04-01T18:02:17.498Z" title="更新于 2024-04-02 02:02:17">2024-04-02</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%80%83%E8%AF%95/">考试</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">2.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>10分钟</span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="Part1-17个题目"><a href="#Part1-17个题目" class="headerlink" title="Part1 17个题目"></a>Part1 17个题目</h2><p>第1题.基于角色的访问控制-RBAC<br>第2题.节点维护—指定node节点不可用<br>第3题.K8s版本升级<br>第4题.Etcd数据库备份恢复<br>第5题.网络策略NetworkPolicy<br>第6题.四层负载均衡service<br>第7题.七层负载均衡Ingress<br>第8题.Deployment管理pod扩缩容<br>第9题.pod指定节点部署<br>第10题.检查Node节点的健康状态<br>第11题.一个Pod封装多个容器<br>第12题.持久化存储卷PersistentVolume<br>第13题.PersistentVolumeClaim<br>第14题.监控Pod日志<br>第15题.Sidecar代理<br>第16题.监控Pod度量指标<br>第17题.集群故障排查——kubelet故障</p>
<h2 id="Part2-准备"><a href="#Part2-准备" class="headerlink" title="Part2 准备"></a>Part2 准备</h2><p>vim ~&#x2F;.bashrc<br>alias k&#x3D;”kubectl”<br>export drc&#x3D;”–dry-run&#x3D;client -oyaml”<br>export now&#x3D;”–force –grace-period 0”<br>source ~&#x2F;.bashrc</p>
<h2 id="Part3-解题"><a href="#Part3-解题" class="headerlink" title="Part3 解题"></a>Part3 解题</h2><h3 id="1-RBAC-4分"><a href="#1-RBAC-4分" class="headerlink" title="1. RBAC(4分)"></a>1. RBAC(4分)</h3><p>中文解释：<br>创建一个名为deployment-clusterrole的clusterrole，该clusterrole只允许创建Deployment、Daemonset、Statefulset的create操作<br>在名字为app-team1的namespace下创建一个名为cicd-token的serviceAccount，并且将上一步创建clusterrole的权限绑定到该serviceAccount</p>
<p>解法</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">k create clusterrole deployment-clusterrole --verb=create --resource=deployments,daemonsets,statefulsets</span><br><span class="line">k create serviceaccount cicd-token -n app-team1</span><br><span class="line">k create rolebinding role-account-binding --clusterrole=deployment-clusterrole --serviceaccount=app-tema1:cicd-token -n app-team1</span><br></pre></td></tr></table></figure>

<p>验证</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">kubectl auth can-i create deployment --as system:serviceaccount:app-team1:cicd-token -n app-team1 -- <span class="built_in">yes</span></span><br><span class="line">kubectl auth can-i create daemonset --as system:serviceaccount:app-team1:cicd-token -n app-team1  -- <span class="built_in">yes</span></span><br><span class="line">kubectl auth can-i create statefulset --as system:serviceaccount:app-team1:cicd-token -n app-team1 -- <span class="built_in">yes</span></span><br><span class="line">kubectl auth can-i create pod --as system:serviceaccount:app-team1:cicd-token -n app-team1 -- no</span><br></pre></td></tr></table></figure>

<p>参考：<br><a target="_blank" rel="noopener" href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/">https://kubernetes.io/docs/reference/access-authn-authz/rbac/</a><br><a target="_blank" rel="noopener" href="https://kubernetes.io/zh-cn/docs/tasks/configure-pod-container/configure-service-account/">https://kubernetes.io/zh-cn/docs/tasks/configure-pod-container/configure-service-account/</a></p>
<h3 id="2-节点维护（4分）"><a href="#2-节点维护（4分）" class="headerlink" title="2. 节点维护（4分）"></a>2. 节点维护（4分）</h3><p>将ek8s-node-1节点设置为不可用，然后重新调度该节点上的所有Pod</p>
<p>解法</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kubectl config use-context ek8s</span><br><span class="line">k cordon ek8s-node-1</span><br><span class="line">k drain ek8s-node-1 --ignore-daesonsets --delete-emptydir-data --force</span><br></pre></td></tr></table></figure>

<p>参考：<br><a target="_blank" rel="noopener" href="https://kubernetes.io/zh/docs/tasks/configure-pod-container/">https://kubernetes.io/zh/docs/tasks/configure-pod-container/</a><br><a target="_blank" rel="noopener" href="https://kubernetes.io/zh-cn/docs/tasks/administer-cluster/kubeadm/kubeadm-upgrade/">https://kubernetes.io/zh-cn/docs/tasks/administer-cluster/kubeadm/kubeadm-upgrade/</a><br><a target="_blank" rel="noopener" href="https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands#drain">https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands#drain</a></p>
<h3 id="3-K8s升级版本（7分）"><a href="#3-K8s升级版本（7分）" class="headerlink" title="3. K8s升级版本（7分）"></a>3. K8s升级版本（7分）</h3><p>将master节点升级到v1.29.00，不升级相关组件</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">kubectl cordon k8s-master01</span><br><span class="line">kubectl drain k8s-master01 --ignore-daemonsets --delete-emptydir-data --force</span><br><span class="line"></span><br><span class="line">ssh k8s-master01</span><br><span class="line">sudo -i</span><br><span class="line">apt update -y &amp;&amp;  apt-cache madison kubeadm</span><br><span class="line">apt-mark unhold kubeadm &amp;&amp; \</span><br><span class="line">apt-get update &amp;&amp; sudo apt-get install -y kubeadm=<span class="string">&#x27;1.29.x-*&#x27;</span> &amp;&amp; \</span><br><span class="line">apt-mark hold kubeadm</span><br><span class="line"></span><br><span class="line">kubeadm version</span><br><span class="line">kubeadm upgrade plan --etcd-upgrade=<span class="literal">false</span> </span><br><span class="line">kubeadm upgrade apply v1.29.x</span><br><span class="line"></span><br><span class="line">apt-mark unhold kubelet kubectl &amp;&amp; \</span><br><span class="line">apt-get update &amp;&amp; sudo apt-get install -y kubelet=<span class="string">&#x27;1.29.x-*&#x27;</span> kubectl=<span class="string">&#x27;1.29.x-*&#x27;</span> &amp;&amp; \</span><br><span class="line">apt-mark hold kubelet kubectl</span><br><span class="line"></span><br><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart kubelet</span><br><span class="line"></span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line"></span><br><span class="line">kubectl uncordon k8s-master01</span><br></pre></td></tr></table></figure>

<h3 id="4-etcd备份与恢复（7分）"><a href="#4-etcd备份与恢复（7分）" class="headerlink" title="4. etcd备份与恢复（7分）"></a>4. etcd备份与恢复（7分）</h3><p>针对etcd实例<a href="https://127.0.0.1:2379创建一个快照，保存到">https://127.0.0.1:2379创建一个快照，保存到</a> &#x2F;srv&#x2F;data&#x2F;etcd-snapshot.db。在创建快照的过程中，如果卡住了，就键入ctrl+c终止，然后重试。<br>然后恢复一个已经存在的快照：&#x2F;var&#x2F;lib&#x2F;backup&#x2F;etcd-snapshot-previous.db<br>执行etcdctl命令的证书存放在：<br>ca证书：&#x2F;opt&#x2F;KUIN00601&#x2F;ca.crt<br>客户端证书：&#x2F;opt&#x2F;KUIN00601&#x2F;etcd-client.crt<br>客户端密钥：&#x2F;opt&#x2F;KUIN00601&#x2F;etcd-client.key</p>
<p>解法</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#备份</span></span><br><span class="line">ETCDCTL_API=3 etcdctl --endpoints=<span class="string">&quot;https://127.0.0.1:2379&quot;</span> --cacert=/opt/KUIN00601/ca.crt --cert=/opt/KUIN00601/etcd-client.crt --key=/opt/KUIN00601/etcd-client.key snapshot save /srv/data/etcd-snapshot.db</span><br><span class="line"></span><br><span class="line"><span class="comment">#恢复(如果恢复后集群崩掉，可以跳过)</span></span><br><span class="line">systemctl stop etcd</span><br><span class="line"><span class="built_in">mkdir</span> -p /opt/etcd-backup</span><br><span class="line"><span class="built_in">mv</span> /etc/kubernetes/manifests/kube-* /opt/etcd-backup/</span><br><span class="line">ETCDCTL_API=3 etcdctl --endpoints=<span class="string">&quot;https://127.0.0.1:2379&quot;</span> --cacert=/opt/KUIN00601/ca.crt --cert=/opt/KUIN00601/etcd-client.crt --key=/opt/KUIN00601/etcd-client.key snapshot restore /var/lib/backup/etcd-snapshot-previous.db --data-dir=/var/lib/backup/</span><br><span class="line">vim /etc/kubernetes/manifests/etcd.yaml, change volume from /var/lib/etcd/ to /var/lib/backup</span><br><span class="line"><span class="built_in">chown</span> -R etcd:etcd /var/lib/backup</span><br><span class="line"><span class="built_in">mv</span> /opt/etcd-backup/ /etc/kubernetes/manifests/</span><br><span class="line">systemctl restart etcd</span><br></pre></td></tr></table></figure>

<h3 id="5-NetworkPolicy（7分）"><a href="#5-NetworkPolicy（7分）" class="headerlink" title="5. NetworkPolicy（7分）"></a>5. NetworkPolicy（7分）</h3><p>创建一个名字为allow-port-from-namespace的NetworkPolicy，这个NetworkPolicy允许internal命名空间下的Pod访问该命名空间下的9000端口。<br>并且不允许不是internal命令空间的下的Pod访问<br>不允许访问没有监听9000端口的Pod。</p>
<p>解法：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">vim 5.yaml</span><br><span class="line">-----------------</span><br><span class="line">apiVersion: networking.k8s.io/v1</span><br><span class="line">kind: NetworkPolicy</span><br><span class="line">metadata:</span><br><span class="line">  name: allow-port-from-namespace</span><br><span class="line">  namespace: internal</span><br><span class="line">spec:</span><br><span class="line">  podSelector: &#123;&#125;</span><br><span class="line">  policyTypes:</span><br><span class="line">  - Ingress</span><br><span class="line">  ingress:</span><br><span class="line">  - from:</span><br><span class="line">    - podSelector: &#123;&#125;</span><br><span class="line">    ports:</span><br><span class="line">    - port: 9000</span><br><span class="line">      protocol: TCP</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">k apply -f 5.yaml</span><br></pre></td></tr></table></figure>

<h3 id="6-service（7分）"><a href="#6-service（7分）" class="headerlink" title="6. service（7分）"></a>6. service（7分）</h3><p>重新配置一个已经存在的deployment front-end，在名字为nginx的容器里面添加一个端口配置，名字为http，暴露端口号为80&#x2F;TCP，然后创建一个service，名字为front-end-svc，暴露该deployment的http端口，并且service的类型为NodePort。</p>
<p>解法：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Add config into existing deployment front-end</span><br><span class="line">k edit deployment front-end</span><br><span class="line">    spec:</span><br><span class="line">      containers:</span><br><span class="line">      - name: nginx</span><br><span class="line">        image: nginx</span><br><span class="line">        <span class="comment"># 需要加这四行</span></span><br><span class="line">        ports:</span><br><span class="line">        - name: http</span><br><span class="line">          containerPort: 80</span><br><span class="line">          protocol: TCP</span><br><span class="line"></span><br><span class="line">k expose deploy front-end --name=front-end-svc --port=80 --<span class="built_in">type</span>=NodePort --target-port=http</span><br></pre></td></tr></table></figure>

<h3 id="7-Ingress-7分"><a href="#7-Ingress-7分" class="headerlink" title="7. Ingress(7分)"></a>7. Ingress(7分)</h3><p>在ing-internal 命名空间下创建一个ingress，名字为pong，代理的service hi，端口为5678，配置路径&#x2F;hi。<br>验证：访问curl -kL <INTERNAL_IP>&#x2F;hi会返回hi。</p>
<p>解法：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">vim 7-ing-class.yaml</span><br><span class="line">apiVersion: networking.k8s.io/v1</span><br><span class="line">kind: IngressClass</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    app.kubernetes.io/component: controller</span><br><span class="line">  name: nginx-example</span><br><span class="line">  annotations:</span><br><span class="line">    ingressclass.kubernetes.io/is-default-class: <span class="string">&quot;true&quot;</span></span><br><span class="line">spec:</span><br><span class="line">  controller: k8s.io/ingress-nginx</span><br><span class="line"></span><br><span class="line">vim 7-ing.yaml</span><br><span class="line">apiVersion: networking.k8s.io/v1</span><br><span class="line">kind: Ingress</span><br><span class="line">metadata:</span><br><span class="line">  name: pong</span><br><span class="line">  namespace: ing-internal</span><br><span class="line">  annotations:</span><br><span class="line">    nginx.ingress.kubernetes.io  <span class="comment">#如果ing没有internal ip，就添加这一行</span></span><br><span class="line">    nginx.ingress.kubernetes.io/rewrite-target: /</span><br><span class="line">spec:</span><br><span class="line">  ingressClassName: nginx</span><br><span class="line">  rules:</span><br><span class="line">  - http:</span><br><span class="line">      paths:</span><br><span class="line">      - path: /hi</span><br><span class="line">        pathType: Prefix</span><br><span class="line">        backend:</span><br><span class="line">          service:</span><br><span class="line">            name: hi</span><br><span class="line">            port:</span><br><span class="line">              number: 5678</span><br><span class="line"></span><br><span class="line">k apply -f 7-ing.yaml</span><br><span class="line">curl -kL &lt;internal-ip&gt;/hi</span><br></pre></td></tr></table></figure>

<h3 id="8-Deployment缩扩容-4分"><a href="#8-Deployment缩扩容-4分" class="headerlink" title="8. Deployment缩扩容(4分)"></a>8. Deployment缩扩容(4分)</h3><p>扩容名字为loadbalancer的deployment的副本数为6</p>
<p>解法：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl config use-context k8s</span><br><span class="line">k scale --replicas=6 deployment loadbalancer</span><br></pre></td></tr></table></figure>

<h3 id="9-指定节点部署（4分）"><a href="#9-指定节点部署（4分）" class="headerlink" title="9. 指定节点部署（4分）"></a>9. 指定节点部署（4分）</h3><p>创建一个Pod，名字为nginx-kusc00401，镜像地址是nginx，调度到具有disk&#x3D;spinning标签的节点上</p>
<p>解法：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">k run nginx-kusc00401 --image=nginx <span class="variable">$drc</span> &gt; 9.yaml</span><br><span class="line">vim 9.yaml</span><br><span class="line">vim pod-ns.yaml</span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Pod</span><br><span class="line">metadata:</span><br><span class="line">  name: nginx-kusc00401</span><br><span class="line">  labels:</span><br><span class="line">    role: nginx-kusc00401</span><br><span class="line">spec:</span><br><span class="line">  nodeSelector:   <span class="comment">#添加nodeSelector标签，在spec下面，没有就打标签</span></span><br><span class="line">    disk: spinning</span><br><span class="line">  containers:</span><br><span class="line">    - name: nginx</span><br><span class="line">      image: nginx</span><br><span class="line"></span><br><span class="line">k apply -f 9.yaml</span><br></pre></td></tr></table></figure>

<h3 id="10-检查node节点健康状态（4分）"><a href="#10-检查node节点健康状态（4分）" class="headerlink" title="10. 检查node节点健康状态（4分）"></a>10. 检查node节点健康状态（4分）</h3><p>检查集群中有多少节点为Ready状态，并且去除包含NoSchedule污点的节点。之后将数字写到&#x2F;opt&#x2F;KUSC00402&#x2F;kusc00402.txt</p>
<p>解法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl config use-context k8s</span><br><span class="line">k get nodes|grep -v &quot;Taint&quot;|grep -v &quot;Noschedule&quot;|wc -l &gt; /opt/KUSC00402/kusc00402.txt</span><br></pre></td></tr></table></figure>

<h3 id="11-一个pod多个容器-4分"><a href="#11-一个pod多个容器-4分" class="headerlink" title="11. 一个pod多个容器(4分)"></a>11. 一个pod多个容器(4分)</h3><p>创建一个Pod，名字为kucc1，这个Pod可能包含1-4容器，该题为四个：nginx+redis+memcached+consul</p>
<p>解法：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">k run kucc1 --image=nginx <span class="variable">$drc</span> &gt; 11.yaml</span><br><span class="line">然后补全所有容器信息，最后apply</span><br><span class="line">k apply -f 11.yaml</span><br></pre></td></tr></table></figure>

<h3 id="12-Persistent-Volume-4分"><a href="#12-Persistent-Volume-4分" class="headerlink" title="12. Persistent Volume(4分)"></a>12. Persistent Volume(4分)</h3><p>创建一个pv，名字为app-config，大小为2Gi，访问权限为ReadWriteMany。Volume的类型为hostPath，路径为&#x2F;srv&#x2F;app-config</p>
<p>解法：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: v1</span><br><span class="line">kind: PersistentVolume</span><br><span class="line">metadata:</span><br><span class="line">  name: app-config</span><br><span class="line">  labels:</span><br><span class="line">    <span class="built_in">type</span>: <span class="built_in">local</span></span><br><span class="line">spec:</span><br><span class="line">  storageClassName: manual   <span class="comment"># 需要有这一项吗？题目没有要求，（可以不写）</span></span><br><span class="line">  volumeMode: Filesystem</span><br><span class="line">  capacity:</span><br><span class="line">    storage: 2Gi</span><br><span class="line">  accessModes:</span><br><span class="line">    - ReadWriteMany</span><br><span class="line">  hostPath:</span><br><span class="line">    path: <span class="string">&quot;/srv/app-config&quot;</span></span><br><span class="line"></span><br><span class="line">k apply -f 12.yaml</span><br></pre></td></tr></table></figure>
<p>参考：<br><a target="_blank" rel="noopener" href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-persistent-volume-storage/">https://kubernetes.io/docs/tasks/configure-pod-container/configure-persistent-volume-storage/</a><br><a target="_blank" rel="noopener" href="https://kubernetes.io/zh-cn/docs/concepts/storage/persistent-volumes/">https://kubernetes.io/zh-cn/docs/concepts/storage/persistent-volumes/</a><br>可以ctrl+F 搜003，会直接跳转到创建pv<br><a target="_blank" rel="noopener" href="https://kubernetes.io/zh-cn/docs/tasks/configure-pod-container/configure-persistent-volume-storage/#create-a-persistentvolume">https://kubernetes.io/zh-cn/docs/tasks/configure-pod-container/configure-persistent-volume-storage/#create-a-persistentvolume</a></p>
<h3 id="13-监控Pod度量指标（5分）"><a href="#13-监控Pod度量指标（5分）" class="headerlink" title="13. 监控Pod度量指标（5分）"></a>13. 监控Pod度量指标（5分）</h3><p>找出具有name&#x3D;cpu-user的Pod，并过滤出使用CPU最高的Pod，然后把它的名字写在已经存在的 &#x2F;opt&#x2F;KUTR00401&#x2F;KUTR00401.txt文件里（注意他没有说指定namespace。所以需要使用-A指定所以namespace）</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">k config use-context k8s</span><br><span class="line">k top pod -A -l name=cpu-user</span><br><span class="line">NAMESPACE     NAME                       CPU(cores)   MEMORY(bytes)   </span><br><span class="line">kube-system   coredns-54d67798b7-hl8xc   7m           8Mi   </span><br><span class="line">kube-system   coredns-54d67798b7-m4m2q   6m           8Mi</span><br><span class="line"></span><br><span class="line">k <span class="string">&quot;coredns-54d67798b7-hl8xc&quot;</span> &gt; /opt/KUTR00401/KUTR00401.txt</span><br></pre></td></tr></table></figure>

<h3 id="14-监控pod日志（5分）"><a href="#14-监控pod日志（5分）" class="headerlink" title="14. 监控pod日志（5分）"></a>14. 监控pod日志（5分）</h3><p>监控名为foobar的Pod的日志，并过滤出具有unable-access-website信息的行，然后将写入到 &#x2F;opt&#x2F;KUTR00101&#x2F;foobar</p>
<p>解法</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">k logs foobar|grep unable-access-website &gt; /opt/KUTR00101/foobar</span><br></pre></td></tr></table></figure>

<h3 id="15-CSI和PVC"><a href="#15-CSI和PVC" class="headerlink" title="15. CSI和PVC"></a>15. CSI和PVC</h3><p>创建一个名字为pv-volume的pvc，指定storageClass为csi-hostpath-sc，大小为10Mi<br>然后创建一个Pod，名字为web-server，镜像为nginx，并且挂载该PVC至&#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html，挂载的权限为ReadWriteOnce。之后通过 kubectl edit或者 kubectl path将pvc改成70Mi，并且记录修改记录。</p>
<p>解法：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">vim 15-pvc.yaml</span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: PersistentVolumeClaim</span><br><span class="line">metadata:</span><br><span class="line">  name: pv-volume</span><br><span class="line">spec:</span><br><span class="line">  accessModes:</span><br><span class="line">  - ReadWriteOnce</span><br><span class="line">  volumeMode: Filesystem</span><br><span class="line">  resources:</span><br><span class="line">    requests:</span><br><span class="line">      storage: 10Mi</span><br><span class="line">  storageClassName: csi-hostpath-sc</span><br><span class="line"></span><br><span class="line">k apply -f 15-pvc.yaml</span><br><span class="line"></span><br><span class="line">vim 15-pod.yaml</span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Pod</span><br><span class="line">metadata:</span><br><span class="line">  name: pv-volume</span><br><span class="line">spec:</span><br><span class="line">  volumes:</span><br><span class="line">    - name: pv-volume</span><br><span class="line">      persistentVolumeClaim:</span><br><span class="line">        claimName: pv-volume</span><br><span class="line">  containers:</span><br><span class="line">    - name: web-server</span><br><span class="line">      image: nginx</span><br><span class="line">      volumeMounts:</span><br><span class="line">        - mountPath: <span class="string">&quot;/usr/share/nginx/html&quot;</span></span><br><span class="line">          name: pv-volume</span><br><span class="line"></span><br><span class="line">k apply -f 15-pod.yaml</span><br><span class="line"></span><br><span class="line">kubectl edit pvc pv-volume</span><br><span class="line">kubectl edit pvc pv-volume --record</span><br><span class="line">kubectl edit pvc pv-volume --save-config</span><br></pre></td></tr></table></figure>

<h3 id="16-sidecar-7分"><a href="#16-sidecar-7分" class="headerlink" title="16. sidecar(7分)"></a>16. sidecar(7分)</h3><p>添加一个名为busybox且镜像为busybox的sidecar到一个已经存在的名为legacy-app的Pod上，这个sidecar的启动命令为 &#x2F;bin&#x2F;sh, -c, ‘tail -n+1 -f &#x2F;var&#x2F;log&#x2F;legacy-app.log’。<br>并且这个sidecar和原有的镜像挂载一个名为logs的volume，挂载的目录为&#x2F;var&#x2F;log&#x2F;。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">k get pod legacy-app -o yaml &gt; c-sidecar.yaml</span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Pod</span><br><span class="line">metadata:</span><br><span class="line">  name: legacy-app</span><br><span class="line">spec:</span><br><span class="line">  containers:</span><br><span class="line">  - name: count</span><br><span class="line">    image: busybox</span><br><span class="line">    args:</span><br><span class="line">    - /bin/sh</span><br><span class="line">    - -c</span><br><span class="line">    - &gt;</span><br><span class="line">      i=0;</span><br><span class="line">      <span class="keyword">while</span> <span class="literal">true</span>;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;<span class="subst">$(date)</span> INFO <span class="variable">$i</span>&quot;</span> &gt;&gt; /var/log/legacy-ap.log;</span><br><span class="line">        i=$((i+<span class="number">1</span>));</span><br><span class="line">        <span class="built_in">sleep</span> 1;</span><br><span class="line">      <span class="keyword">done</span></span><br><span class="line">      <span class="comment"># 以下为添加部分</span></span><br><span class="line">    volumeMounts:</span><br><span class="line">    - name: logs</span><br><span class="line">      mountPath: /var/log</span><br><span class="line">  - name: busybox</span><br><span class="line">    image: busybox</span><br><span class="line">    args: [/bin/sh, -c, <span class="string">&#x27;tail -n+1 -f /var/log/legacy-ap.log&#x27;</span>]</span><br><span class="line">    volumeMounts:</span><br><span class="line">    - name: logs</span><br><span class="line">      mountPath: /var/log</span><br><span class="line">  volumes:</span><br><span class="line">  - name: logs</span><br><span class="line">    emptyDir: &#123;&#125;</span><br><span class="line"></span><br><span class="line">k delete -f c-sidecar.yaml</span><br><span class="line">k create -f c-sidecar.yaml</span><br></pre></td></tr></table></figure>

<h3 id="17-kubelet故障（13分）"><a href="#17-kubelet故障（13分）" class="headerlink" title="17. kubelet故障（13分）"></a>17. kubelet故障（13分）</h3><p>一个名为wk8s-node-0的节点状态为NotReady，让其他恢复至正常状态，并确认所有的更改开机自动完成</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ssh wk8s-node-0</span><br><span class="line">k get nodes</span><br><span class="line">systemctl status kubelet <span class="comment"># 然后fix</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://eryoung2.github.io">ErYoung2</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://eryoung2.github.io/2024/04/02/cka%E7%9C%9F%E9%A2%98/">http://eryoung2.github.io/2024/04/02/cka%E7%9C%9F%E9%A2%98/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://eryoung2.github.io" target="_blank">Eryoung2的个人博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/cka/">cka</a></div><div class="post_share"><div class="social-share" data-image="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/gh/overtrue/share.js@master/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/04/27/CKS%E7%9C%9F%E9%A2%98-kube-bench%E4%BF%AE%E5%A4%8D%E4%B8%8D%E5%AE%89%E5%85%A8%E9%A1%B9/"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">CKS真题 -- kube-bench修复不安全项</div></div></a></div><div class="next-post pull-right"><a href="/2024/03/11/Macbook-Air%E5%8E%BB%E6%8E%89%E5%88%98%E6%B5%B7/"><img class="next-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Macbook Air去掉刘海</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Valine</span><span class="switch-btn"></span><span class="second-comment">Disqus</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/panda.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">ErYoung2</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">121</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">57</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">28</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/ErYoung2"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">eryoung2写字的地方</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Part1-17%E4%B8%AA%E9%A2%98%E7%9B%AE"><span class="toc-number">1.</span> <span class="toc-text">Part1 17个题目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Part2-%E5%87%86%E5%A4%87"><span class="toc-number">2.</span> <span class="toc-text">Part2 准备</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Part3-%E8%A7%A3%E9%A2%98"><span class="toc-number">3.</span> <span class="toc-text">Part3 解题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-RBAC-4%E5%88%86"><span class="toc-number">3.1.</span> <span class="toc-text">1. RBAC(4分)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%8A%82%E7%82%B9%E7%BB%B4%E6%8A%A4%EF%BC%884%E5%88%86%EF%BC%89"><span class="toc-number">3.2.</span> <span class="toc-text">2. 节点维护（4分）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-K8s%E5%8D%87%E7%BA%A7%E7%89%88%E6%9C%AC%EF%BC%887%E5%88%86%EF%BC%89"><span class="toc-number">3.3.</span> <span class="toc-text">3. K8s升级版本（7分）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-etcd%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%EF%BC%887%E5%88%86%EF%BC%89"><span class="toc-number">3.4.</span> <span class="toc-text">4. etcd备份与恢复（7分）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-NetworkPolicy%EF%BC%887%E5%88%86%EF%BC%89"><span class="toc-number">3.5.</span> <span class="toc-text">5. NetworkPolicy（7分）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-service%EF%BC%887%E5%88%86%EF%BC%89"><span class="toc-number">3.6.</span> <span class="toc-text">6. service（7分）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-Ingress-7%E5%88%86"><span class="toc-number">3.7.</span> <span class="toc-text">7. Ingress(7分)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-Deployment%E7%BC%A9%E6%89%A9%E5%AE%B9-4%E5%88%86"><span class="toc-number">3.8.</span> <span class="toc-text">8. Deployment缩扩容(4分)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-%E6%8C%87%E5%AE%9A%E8%8A%82%E7%82%B9%E9%83%A8%E7%BD%B2%EF%BC%884%E5%88%86%EF%BC%89"><span class="toc-number">3.9.</span> <span class="toc-text">9. 指定节点部署（4分）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-%E6%A3%80%E6%9F%A5node%E8%8A%82%E7%82%B9%E5%81%A5%E5%BA%B7%E7%8A%B6%E6%80%81%EF%BC%884%E5%88%86%EF%BC%89"><span class="toc-number">3.10.</span> <span class="toc-text">10. 检查node节点健康状态（4分）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-%E4%B8%80%E4%B8%AApod%E5%A4%9A%E4%B8%AA%E5%AE%B9%E5%99%A8-4%E5%88%86"><span class="toc-number">3.11.</span> <span class="toc-text">11. 一个pod多个容器(4分)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-Persistent-Volume-4%E5%88%86"><span class="toc-number">3.12.</span> <span class="toc-text">12. Persistent Volume(4分)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-%E7%9B%91%E6%8E%A7Pod%E5%BA%A6%E9%87%8F%E6%8C%87%E6%A0%87%EF%BC%885%E5%88%86%EF%BC%89"><span class="toc-number">3.13.</span> <span class="toc-text">13. 监控Pod度量指标（5分）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-%E7%9B%91%E6%8E%A7pod%E6%97%A5%E5%BF%97%EF%BC%885%E5%88%86%EF%BC%89"><span class="toc-number">3.14.</span> <span class="toc-text">14. 监控pod日志（5分）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-CSI%E5%92%8CPVC"><span class="toc-number">3.15.</span> <span class="toc-text">15. CSI和PVC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-sidecar-7%E5%88%86"><span class="toc-number">3.16.</span> <span class="toc-text">16. sidecar(7分)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-kubelet%E6%95%85%E9%9A%9C%EF%BC%8813%E5%88%86%EF%BC%89"><span class="toc-number">3.17.</span> <span class="toc-text">17. kubelet故障（13分）</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/06/13/%E3%80%8A%E5%85%AD%E7%88%BB%E3%80%8B-%E6%8F%BD%E4%BD%AC/" title="《六爻》-- 揽佬"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="《六爻》-- 揽佬"/></a><div class="content"><a class="title" href="/2025/06/13/%E3%80%8A%E5%85%AD%E7%88%BB%E3%80%8B-%E6%8F%BD%E4%BD%AC/" title="《六爻》-- 揽佬">《六爻》-- 揽佬</a><time datetime="2025-06-12T16:54:45.000Z" title="发表于 2025-06-13 00:54:45">2025-06-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/09/%E3%80%8A%E7%BB%B5%E7%BB%B5%E3%80%8B-%E9%99%88%E5%A5%95%E8%BF%85/" title="《绵绵》-- 陈奕迅"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="《绵绵》-- 陈奕迅"/></a><div class="content"><a class="title" href="/2025/06/09/%E3%80%8A%E7%BB%B5%E7%BB%B5%E3%80%8B-%E9%99%88%E5%A5%95%E8%BF%85/" title="《绵绵》-- 陈奕迅">《绵绵》-- 陈奕迅</a><time datetime="2025-06-08T16:50:56.000Z" title="发表于 2025-06-09 00:50:56">2025-06-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/07/%E6%88%91%E5%BF%83%E6%80%81%E7%9C%9F%E7%9A%84%E5%BE%88%E5%B7%AE/" title="我心态真的很差"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="我心态真的很差"/></a><div class="content"><a class="title" href="/2025/06/07/%E6%88%91%E5%BF%83%E6%80%81%E7%9C%9F%E7%9A%84%E5%BE%88%E5%B7%AE/" title="我心态真的很差">我心态真的很差</a><time datetime="2025-06-07T15:38:37.000Z" title="发表于 2025-06-07 23:38:37">2025-06-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/05/28/%E5%BF%83%E7%83%A6/" title="心烦"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="心烦"/></a><div class="content"><a class="title" href="/2025/05/28/%E5%BF%83%E7%83%A6/" title="心烦">心烦</a><time datetime="2025-05-28T14:33:55.000Z" title="发表于 2025-05-28 22:33:55">2025-05-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/04/23/%E5%8D%A1%E4%B9%94%E4%B8%B9%EF%BC%81/" title="卡乔丹！"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="卡乔丹！"/></a><div class="content"><a class="title" href="/2025/04/23/%E5%8D%A1%E4%B9%94%E4%B8%B9%EF%BC%81/" title="卡乔丹！">卡乔丹！</a><time datetime="2025-04-22T23:26:19.000Z" title="发表于 2025-04-23 07:26:19">2025-04-23</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By ErYoung2</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: '',
      appKey: '',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script>function loadDisqus () {
  var disqus_config = function () {
    this.page.url = 'http://eryoung2.github.io/2024/04/02/cka%E7%9C%9F%E9%A2%98/'
    this.page.identifier = '2024/04/02/cka真题/'
    this.page.title = 'cka真题'
  };

  window.disqusReset = () => {
    DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  if (window.DISQUS) disqusReset()
  else {
    (function() { 
      var d = document, s = d.createElement('script');
      s.src = 'https://.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  }
}

if ('Valine' === 'Disqus' || !false) {
  if (false) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
  else loadDisqus()
} else {
  function loadOtherComment () {
    loadDisqus()
  }
}
</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-heart.min.js" async="async" mobile="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>